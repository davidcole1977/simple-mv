'use strict';var sh=require('./simple-helpers'),_=require('lodash'),sce=require('./simple-create-extend'),simpleEvents=require('./simple-events'),modelSubs=require('./app-subscriptions'),GLOBAL_CONFIG=require('./global-config'),EVENT_TYPES=GLOBAL_CONFIG.EVENT_TYPES,prototype,defaultOptions,create,extend;prototype={bind:function(options){var modelData,viewDatum='undefined'==typeof options.viewDatum?null:options.viewDatum,modelDatum='undefined'==typeof options.modelDatum?null:options.modelDatum,eventNameSpace=null===modelDatum?'':':'+modelDatum;if(null===modelDatum)modelData=options.model.getRawData();else try{modelData=options.model.get(modelDatum)}catch(error){modelData=null}null!==modelDatum&&null===viewDatum&&(viewDatum=modelDatum),null===viewDatum?this.data=modelData:this.data[viewDatum]=modelData,options.model.subsList.createSubscription(EVENT_TYPES.DATUM_UPDATE+eventNameSpace,this.receiveBindEvent.bind(this,modelDatum,viewDatum))},addListener:function(options,callback){var eventNameSpace='string'==typeof options.keypath?':'+options.keypath:'';options.model.subsList.createSubscription(options.event+eventNameSpace,callback)},receiveBindEvent:function(modelDatum,viewDatum,modelEvent){var modelData=null===modelDatum?modelEvent.model.getRawData():modelEvent.model.get(modelDatum);null!==viewDatum?this.data[viewDatum]=modelData:this.data=modelData},emitViewEvent:function(){}},_.assign(prototype,simpleEvents),defaultOptions={type:'view',data:{}},create=sce.create.bind(null,prototype,defaultOptions),extend=sce.extend.bind(null,create),module.exports={create:create,extend:extend};