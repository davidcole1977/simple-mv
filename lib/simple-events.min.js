'use strict';function unsubscribe(subscription){subscription.unsubscribe()}var sh=require('./simple-helpers'),_=require('lodash'),appSubsLists=require('./app-subscriptions');module.exports={emitEvent:function(options){var publishTopics=[options.eventType,options.eventType+':'+this.id];options.keypath&&publishTopics.push(options.eventType+':'+this.id+':'+options.keypath),publishTopics.forEach(function(topic){appSubsLists.publish(topic,options.publishParams)})},on:function(){var newSubscription,topic=arguments[0],topicNameSpace=2===arguments.length?null:arguments[1],callback=2===arguments.length?arguments[1]:arguments[2];'undefined'==typeof this.selfSubscriptions[topic]&&(this.selfSubscriptions[topic]={unNameSpaced:[]}),null!==topicNameSpace&&'undefined'==typeof this.selfSubscriptions[topic][topicNameSpace]&&(this.selfSubscriptions[topic][topicNameSpace]=[]),newSubscription=appSubsLists.createSubscription(topic,callback),null===topicNameSpace?this.selfSubscriptions[topic].unNameSpaced.push(newSubscription):this.selfSubscriptions[topic][topicNameSpace].push(newSubscription)},off:function(topic,nameSpace){var subsArray;subsArray='undefined'==typeof nameSpace?this.selfSubscriptions[topic].unNameSpaced:this.selfSubscriptions[topic][nameSpace],subsArray.forEach(unsubscribe),subsArray.splice(0,subsArray.length)}};